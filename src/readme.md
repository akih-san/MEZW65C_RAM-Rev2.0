# ファームウェアRev2.0のコマンド

- コマンド一覧

| コマンド名 | 説明                                            |
|-----------|-------------------------------------------------|
|ファイル名  |ファイルを実行する                                |
|DIR        |ファイルの一覧表示（ファイル名のみ）                |
|LS 　      |ファイルの一覧表示（ファイル名とファイルサイズ表示）  |
|CD         |階層ディレクトリの移動                             |
|LOAD       |ファイルのロード                                  |
|MDUMP      |メモリのダンプ表示                                |
|MONITOR    |モニターの起動                                    |
|CSTART     |プログラムのコールドスタート                       |
|WSTART     |プログラムのウォームスタート                       |
|RETI       |ＮＭＩ割込みからの復帰                             |
|REG        |W65C02または、W65C816のレジスタ表示                |
|SHOW       |ファイル情報の表示                                |
|FLASH      |ＮＭＩ割込みしたプログラムの終了                    |
|HELP ｜ ?  | コマンド一覧の表示                                |

- ファイルの実行<br>
  Rev2.0では、ファイル管理用の[ファイルヘッダ](https://github.com/akih-san/MEZW65C_RAM-Rev2.0/blob/main/file_header/fileheader.pdf)を持ったファイルを使用します。<br>
  ファイルヘッダ情報は32バイトで、ファイルの先頭にあります。<br>
  Rev2.0対応のファイルであれば、ファイル名を入力するだけで、プログラムを<br>
  実行することが出来ます。<br>
  ![](../photo/run_program.png)<br>
  <br>
  - ファイル名　＜　テキストファイル<br>
    ファイルを実行する際に、テキストファイルを読込む指示をすることが出来ます。<br>
    「＜」の前後にセパレータとして、空白が必要です。<br>
    ![](../photo/fileinput.png)

- DIR<br>
  ファイルの一覧を表示します。
![photo 2](../photo/dir.png)

- LS<br>
  ファイルとファイルサイズの一覧を表示します。
![photo 3](../photo/ls.png)

- CD<br>
  チェンジディレクトリ。カレントディレクトリを移動します。
![photo 4](../photo/cd.png)

- LOAD<br>
  ファイルのロード。ファイルヘッダ情報に従ってファイルをロードします。<br>
  「Ｌ＝ロードアドレス」を指定することで、Lowファイルをメモリ上に<br>
  ロードすることが出来ます。この指定を行うと、ファイルヘッダ情報は<br>
  無視されて、指定したアドレスにファイルがロードされます。<br>
![photo 5](../photo/load.png)

- MDUMP<br>
  メモリの内容を128バイトダンプします。<br>
![photo 6](../photo/mdump.png)

- MONITOR<br>
  モニタを起動します。ネイティブモード時は、W65C816用のモニタが起動します。<br>
  エミュレーションモード時は、W65C02用のモニタが起動します。<br>
![photo 7](../photo/monitor.png)

- CSTART<br>
  起動したプロフラムのコールドスタートを行います。<br>
  このコマンドは、BIOSコール使用のプログラムをCtrl+Qキーで、動作中断して<br>
  Rev2.0ファームウェアに制御が戻っている状態で、プログラムの再起動を行う<br>
  ことが出来ます。プログラムは初期起動されます。<br>
![photo 8](../photo/cstart.png)

- WSTART<br>
  起動したプロフラムのウォームスタートを行います。<br>
  CSTARTコマンドと同様ですが、プログラムの初期化は行われません。<br>
  （BASICインタプリタ等のプログラムがクリアされない）<br>
![photo 9](../photo/wstart.png)

- RETI<br>
  プログラムをCtrl+Qキーで、動作中断してRev2.0ファームウェアに制御が戻っている状態で、<br>
  このコマンドを使用すると、プログラムの実行制御を動作中断したところに戻します。<br>
![photo 10](../photo/reti.png)

- REG<br>
  プログラムをCtrl+Qキーで、動作中断してRev2.0ファームウェアに制御が戻っている時に<br>
  NMIで中断したレジスタの状態を見ることが出来ます。
![photo 11](../photo/reg.png)

- SHOW<br>
  ファイルのファイルヘッダ情報を表示します。
![photo 12](../photo/show.png)

- FLASH<br>
  Ctrl+Qキーで、動作中断したプログラムを終了します。このコマンドを実行後は、<br>
  CSTART,　WSTARTコマンドでプログラムを起動出来なくなります。<br>
![photo 13](../photo/flash.png)

- HELP | ?<br>
  コマンド一覧を表示します。
  ![photo 1](../photo/comlist.png)
